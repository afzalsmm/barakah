<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Barakah Builder</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    // All code here, NO imports/exports!

    function BarakahBuilder() {
      // State and logic
      const [currentLevel, setCurrentLevel] = React.useState(1);
      const [completedHabits, setCompletedHabits] = React.useState({});
      const [selectedDate, setSelectedDate] = React.useState(new Date().toISOString().split('T')[0]);
      const [showDuaModal, setShowDuaModal] = React.useState(false);
      const [selectedDua, setSelectedDua] = React.useState(null);

      // Minimal dua content demo
      const duasContent = {
        'wake-up': {
          title: 'Dua upon Waking Up',
          arabic: 'ÿßŸÑŸíÿ≠ŸéŸÖŸíÿØŸè ŸÑŸêŸÑŸéŸëŸáŸê ÿßŸÑŸéŸëÿ∞ŸêŸä ÿ£Ÿéÿ≠ŸíŸäŸéÿßŸÜŸéÿß ÿ®ŸéÿπŸíÿØŸé ŸÖŸéÿß ÿ£ŸéŸÖŸéÿßÿ™ŸéŸÜŸéÿß ŸàŸéÿ•ŸêŸÑŸéŸäŸíŸáŸê ÿßŸÑŸÜŸèŸëÿ¥ŸèŸàÿ±Ÿè',
          transliteration: "Alhamdu lillaahil-lathee ahyaana ba'da maa amaatanaa wa ilayhin-nushoor",
          translation: "All praise is for Allah who gave us life after having taken it from us and unto Him is the resurrection."
        },
        'sleep': {
          title: 'Dua before Sleeping',
          arabic: 'ÿ®Ÿêÿßÿ≥ŸíŸÖŸêŸÉŸé ÿ±Ÿéÿ®ŸêŸëŸä ŸàŸéÿ∂ŸéÿπŸíÿ™Ÿè ÿ¨ŸéŸÜŸíÿ®ŸêŸä ŸàŸéÿ®ŸêŸÉŸé ÿ£Ÿéÿ±ŸíŸÅŸéÿπŸèŸáŸè ...',
          transliteration: "Bismika rabbee wada'tu janbee wa bika arfa'uhu ...",
          translation: "In Your name my Lord, I lie down and in Your name I rise..."
        }
      };

      // Level and habit definitions (trimmed for brevity)
      const levels = {
        1: {
          title: "Foundation Level",
          description: "Essential Islamic practices and worldly responsibilities",
          habits: [
            { id: 'wake-dua', name: 'Morning Dua (Upon Waking)', category: 'spiritual', type: 'dua', duaKey: 'wake-up' },
            { id: 'fajr', name: 'Fajr Prayer', category: 'prayer', type: 'prayer' },
            { id: 'quran-reading', name: 'Read Quran (10 mins)', category: 'spiritual', type: 'reading' },
            { id: 'exercise', name: 'Exercise/Physical Activity', category: 'worldly', type: 'activity' },
            { id: 'sleep-dua', name: 'Sleep Dua', category: 'spiritual', type: 'dua', duaKey: 'sleep' }
          ]
        },
        2: {
          title: "Growth Level",
          description: "Building upon the foundation with Sunnah practices",
          habits: [
            { id: 'fajr-sunnah', name: 'Fajr Sunnah Prayer', category: 'prayer', type: 'prayer' },
            { id: 'morning-adhkar', name: 'Morning Adhkar', category: 'spiritual', type: 'dhikr' }
          ]
        },
        3: {
          title: "Excellence Level",
          description: "Advanced spiritual practices and personal development",
          habits: [
            { id: 'tahajjud', name: 'Tahajjud Prayer', category: 'prayer', type: 'prayer' },
            { id: 'quran-memorization', name: 'Quran Memorization', category: 'spiritual', type: 'reading' }
          ]
        }
      };

      function getHabitKey(habitId) {
        return `${selectedDate}-${habitId}`;
      }
      function toggleHabit(habitId) {
        const key = getHabitKey(habitId);
        setCompletedHabits(prev => ({
          ...prev,
          [key]: !prev[key]
        }));
      }
      function isHabitCompleted(habitId) {
        return completedHabits[getHabitKey(habitId)] || false;
      }
      function getCompletionPercentage(level) {
        const habits = levels[level].habits;
        const completed = habits.filter(habit => isHabitCompleted(habit.id)).length;
        return Math.round((completed / habits.length) * 100);
      }
      function getCategoryIcon(category) {
        if (category === 'prayer') return <span>üïå</span>;
        if (category === 'spiritual') return <span>üìñ</span>;
        if (category === 'worldly') return <span>üéØ</span>;
        return <span>‚≠ï</span>;
      }
      function openDuaModal(duaKey) {
        setSelectedDua(duasContent[duaKey]);
        setShowDuaModal(true);
      }

      // Demo streak
      function getStreakCount() {
        return 3;
      }

      // UI
      return (
        <div className="min-h-screen bg-gradient-to-br from-emerald-50 to-blue-50 p-4">
          <div className="max-w-2xl mx-auto">
            {/* Header */}
            <div className="text-center mb-8">
              <h1 className="text-4xl font-bold text-emerald-800 mb-2">ÿ®ÿ±ŸÉÿ© Builder</h1>
              <p className="text-gray-600">Building blessed habits, one day at a time</p>
              <div className="mt-4 inline-flex items-center bg-white rounded-full px-4 py-2 shadow-md">
                <span className="mr-2">üèÜ</span>
                <span className="text-sm font-medium">{getStreakCount()} day streak!</span>
              </div>
            </div>
            {/* Date Selector */}
            <div className="mb-6 text-center">
              <input
                type="date"
                value={selectedDate}
                onChange={e => setSelectedDate(e.target.value)}
                className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent"
              />
            </div>
            {/* Level Selector */}
            <div className="mb-8">
              <div className="flex justify-center space-x-4">
                {[1,2,3].map(level => (
                  <button
                    key={level}
                    onClick={() => setCurrentLevel(level)}
                    className={`px-6 py-3 rounded-lg font-medium transition-all ${
                      currentLevel === level
                        ? 'bg-emerald-600 text-white shadow-lg'
                        : 'bg-white text-gray-700 hover:bg-emerald-50'
                    }`}
                  >Level {level}</button>
                ))}
              </div>
            </div>
            {/* Level Info & Habits */}
            <div className="bg-white rounded-xl shadow-lg p-6 mb-8">
              <div className="flex items-center justify-between mb-4">
                <div>
                  <h2 className="text-2xl font-bold text-gray-800">{levels[currentLevel].title}</h2>
                  <p className="text-gray-600">{levels[currentLevel].description}</p>
                </div>
                <div className="text-center">
                  <div className="text-3xl font-bold text-emerald-600">
                    {getCompletionPercentage(currentLevel)}%
                  </div>
                  <div className="text-sm text-gray-500">Complete</div>
                </div>
              </div>
              {/* Progress Bar */}
              <div className="w-full bg-gray-200 rounded-full h-3 mb-6">
                <div
                  className="bg-gradient-to-r from-emerald-500 to-blue-500 h-3 rounded-full transition-all duration-300"
                  style={{ width: `${getCompletionPercentage(currentLevel)}%` }}
                ></div>
              </div>
              {/* Habits List */}
              <div className="space-y-3">
                {levels[currentLevel].habits.map(habit => (
                  <div key={habit.id} className="flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                    <div className="flex items-center space-x-3">
                      <button
                        onClick={() => toggleHabit(habit.id)}
                        className="flex-shrink-0"
                        aria-label={isHabitCompleted(habit.id) ? "Done" : "Mark as done"}
                      >
                        {isHabitCompleted(habit.id)
                          ? <span className="text-emerald-600 text-xl">‚úîÔ∏è</span>
                          : <span className="text-gray-400 text-xl">‚≠ï</span>
                        }
                      </button>
                      <div className="flex items-center space-x-2">
                        {getCategoryIcon(habit.category)}
                        <span className={`font-medium ${isHabitCompleted(habit.id) ? 'text-emerald-700 line-through' : 'text-gray-800'}`}>{habit.name}</span>
                      </div>
                    </div>
                    {habit.type === 'dua' && (
                      <button
                        onClick={() => openDuaModal(habit.duaKey)}
                        className="text-emerald-600 hover:text-emerald-800 text-sm font-medium"
                      >Learn</button>
                    )}
                  </div>
                ))}
              </div>
            </div>
            {/* Dua Modal */}
            {showDuaModal && selectedDua && (
              <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                <div className="bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                  <div className="p-6">
                    <div className="flex justify-between items-center mb-6">
                      <h3 className="text-xl font-bold text-gray-800">{selectedDua.title}</h3>
                      <button
                        onClick={() => setShowDuaModal(false)}
                        className="text-gray-500 hover:text-gray-700"
                      >‚úï</button>
                    </div>
                    <div className="space-y-6">
                      <div className="text-center">
                        <h4 className="font-semibold text-gray-700 mb-2">Arabic</h4>
                        <p className="text-2xl text-right leading-relaxed font-arabic">{selectedDua.arabic}</p>
                      </div>
                      <div>
                        <h4 className="font-semibold text-gray-700 mb-2">Transliteration</h4>
                        <p className="text-lg italic text-gray-600">{selectedDua.transliteration}</p>
                      </div>
                      <div>
                        <h4 className="font-semibold text-gray-700 mb-2">Translation</h4>
                        <p className="text-gray-800">{selectedDua.translation}</p>
                      </div>
                    </div>
                    <div className="mt-6 text-center">
                      <button
                        onClick={() => setShowDuaModal(false)}
                        className="bg-emerald-600 text-white px-6 py-2 rounded-lg hover:bg-emerald-700 transition-colors"
                      >Close</button>
                    </div>
                  </div>
                </div>
              </div>
            )}
          </div>
        </div>
      );
    }

    // Render to DOM
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<BarakahBuilder />);
  </script>
</body>
</html>
